import LayoutHelper from"../helper/LayoutHelper";import ManageHandleBar from"../helper/ManageHandleBar";import SplitSessionStorage from"./SplitSessionStorage";class SplitUtils{static setWrapper(e,t="horizontal",i=!1){this.wrapper=e,this.mode=t,this.modeWrapper=Object.assign(Object.assign({},this.modeWrapper),{[t]:e}),this.userSession=new SplitSessionStorage,this.enableSessionStorage[t]=i,this.cachedMappedSplitPanePosition[t]=null,LayoutHelper.mapElementPosition(null,this.modeWrapper,t,this.cachedMappedSplitPanePosition)}static fixClass(){return this.FIX_CLASS+" "+this.FIX_HELPER_CLASS}static setSplitPaneInstance(e){this.splitPaneInstance?this.splitPaneInstance=Object.assign(Object.assign({},this.splitPaneInstance),e):this.splitPaneInstance=Object.assign({},e)}static getSplitPaneInstance(){return this.splitPaneInstance}static getHandlebarPosition(e){return e<1?(console.error("Section index must be greater than or equal to 1."),-1):2*e-1}static percentageToPixel(e,t){return t&&t.includes("vw")?e/100*window.innerWidth*(parseFloat(t.replace("vw",""))/100):t&&t.includes("vh")?e/100*window.innerHeight*(parseFloat(t.replace("vh",""))/100):t&&t.includes("%")?e/100*parseFloat(t.replace("%","")):e/100*parseFloat(t.replace("px",""))}static pixelToPercentage(e,t){return t.includes("vw")?e/window.innerWidth*100:t.includes("vh")?e/window.innerHeight*100:t.includes("px")?e/parseFloat(t.replace("px",""))*100:e/parseFloat(t.replace("%",""))*100}static isSectionOpen(e,t,i){if(this.modeWrapper[i]){var r=(null==e?void 0:e.children)||(null==(r=this.modeWrapper[i])?void 0:r.children);if(LayoutHelper.mapElementPosition(e,this.modeWrapper,i,this.cachedMappedSplitPanePosition,!0),r&&0<t&&r.length>=t){e=LayoutHelper.getSection(this.cachedMappedSplitPanePosition,i,t);if(null==e||void 0===e)return void console.error(`Section number ${e}. Provide correct section number.`);if(null!=e)return!r[e].classList.contains(this.SECTION_CLASS_HIDE)}}else console.error("Wrapper not set. Call setWrapper before using isSectionOpen.");return!1}static reCheckPaneOpening(i,r){var e;if(!this.modeWrapper[r])return console.error("Wrapper not set. Call setWrapper before using totalHandleCount."),-1;var l=(null==i?void 0:i.children)||(null==(e=this.modeWrapper[r])?void 0:e.children);if(LayoutHelper.mapElementPosition(i,this.modeWrapper,r,this.cachedMappedSplitPanePosition,!0),l&&0<l.length){var s=this.totalPaneCount(i,r);let t=0;for(let e=1;e<=s;e++)this.isSectionOpen(i,e,r)?++t:t;if(t===s)for(let e=1;e<=s;e++){var o=LayoutHelper.getSection(this.cachedMappedSplitPanePosition,r,e);if(null==o||void 0===o)return console.error(`Section number ${o}. Provide correct section number.`),-1;"1"===l[o].style.flexGrow&&l[o].style.removeProperty("flex-grow")}}}static closeSplitter(e=null,t,i,r=null){var l,s,o,a=i||this.mode;this.modeWrapper[i]||e?(o=(null==e?void 0:e.children)||(null==(o=this.modeWrapper[i])?void 0:o.children),LayoutHelper.mapElementPosition(e,this.modeWrapper,i,this.cachedMappedSplitPanePosition,!0),o&&0<t&&o.length>=t&&(null==(i=LayoutHelper.getSection(this.cachedMappedSplitPanePosition,i,t))||void 0===i?console.error(`Section number ${i}. Provide correct section number.`):null!=i&&void 0!==i&&(l=o[i],s=o[i-2],o=o[i+2],a===this.HORIZONTAL&&l?(l.style.flexGrow="0",l.classList.add(this.SECTION_CLASS_HIDE),l.classList.contains(this.FIX_CLASS)&&l.classList.remove(this.FIX_CLASS),r===this.RIGHT?s.style.flexGrow="1":r===this.LEFT||o?o.style.flexGrow="1":s&&(s.style.flexGrow="1"),ManageHandleBar.removeHandleIconOnClose(e,t,this.modeWrapper,this.cachedMappedSplitPanePosition,"horizontal"),this.saveSizesToLocalStorage(this.HORIZONTAL)):a===this.VERTICAL&&l&&(l.style.flexGrow="0",l.classList.add(this.SECTION_CLASS_HIDE),l.classList.contains(this.FIX_CLASS)&&l.classList.remove(this.FIX_CLASS),r===this.BOTTOM?s.style.flexGrow="1":r===this.TOP||o?o.style.flexGrow="1":s&&(s.style.flexGrow="1"),ManageHandleBar.removeHandleIconOnClose(e,t,this.modeWrapper,this.cachedMappedSplitPanePosition,"vertical"),this.saveSizesToLocalStorage(this.VERTICAL))))):console.error("Wrapper not set. Call setWrapper before using closeSplitter.")}static openSplitter(i=null,e,r,l=null){var s=r||this.mode;if(this.modeWrapper[r]||i){var o=(null==i?void 0:i.children)||(null==(o=this.modeWrapper[r])?void 0:o.children);if(LayoutHelper.mapElementPosition(i,this.modeWrapper,r,this.cachedMappedSplitPanePosition,!0),o&&0<e&&o.length>=e){var a=LayoutHelper.getSection(this.cachedMappedSplitPanePosition,r,e);if(null==a)console.error(`Section number ${a}. Provide correct section number.`);else if(null!=a){var n=o[a],p=o[a-2],a=o[a+2],c=(o.length+1)/2;let t=0;for(let e=0;e<c;e++)this.isSectionOpen(i,e+1,r)&&t++;s===this.HORIZONTAL&&n?(n.style.removeProperty("flex-grow"),n.classList.remove(this.SECTION_CLASS_HIDE),n.classList.contains(this.FIX_HELPER_CLASS)&&!n.classList.contains(this.FIX_CLASS)&&n.classList.add(this.FIX_CLASS),l===this.RIGHT?1!==t?(a.style.removeProperty("flex-grow"),p&&p.style.removeProperty("flex-grow")):a.style.flexGrow="1":l===this.LEFT?1!==t?(p.style.removeProperty("flex-grow"),a&&a.style.removeProperty("flex-grow")):p.style.flexGrow="1":a?1!==t?(a.style.removeProperty("flex-grow"),p&&p.style.removeProperty("flex-grow")):a.style.flexGrow="1":p&&(1!==t?(p.style.removeProperty("flex-grow"),a&&a.style.removeProperty("flex-grow")):p.style.flexGrow="1"),this.reCheckPaneOpening(i,this.HORIZONTAL),ManageHandleBar.showHandleIconOnOpen(i,e,this.modeWrapper,this.cachedMappedSplitPanePosition,"horizontal"),this.saveSizesToLocalStorage(s)):s===this.VERTICAL&&n&&(n.style.removeProperty("flex-grow"),n.classList.remove(this.SECTION_CLASS_HIDE),l===this.BOTTOM?1!==t?a.style.removeProperty("flex-grow"):a.style.flexGrow="1":l===this.TOP?1!==t?p.style.removeProperty("flex-grow"):p.style.flexGrow="1":a?1!==t?a.style.removeProperty("flex-grow"):a.style.flexGrow="1":p&&(1!==t?p.style.removeProperty("flex-grow"):p.style.flexGrow="1"),this.reCheckPaneOpening(i,this.VERTICAL),ManageHandleBar.showHandleIconOnOpen(i,e,this.modeWrapper,this.cachedMappedSplitPanePosition,"vertical"),this.saveSizesToLocalStorage(s))}}}else console.error("Wrapper not set. Call setWrapper before using openSplitter.")}static totalPaneCount(e,t){return this.modeWrapper[t]||e?(t=(null==e?void 0:e.children)||(null==(e=this.modeWrapper[t])?void 0:e.children))?(t.length+1)/2:-1:(console.error("Wrapper not set. Call setWrapper before using totalPaneCount."),-1)}static totalHandleCount(e,t){return this.modeWrapper[t]||e?(t=(null==e?void 0:e.children)||(null==(e=this.modeWrapper[t])?void 0:e.children))?Math.abs((t.length+1)/2-t.length):-1:(console.error("Wrapper not set. Call setWrapper before using totalHandleCount."),-1)}static saveSizesToLocalStorage(e="horizontal",t=!1){var i,r=e||this.mode;if(this.modeWrapper[e]){var l=null==(i=this.modeWrapper[r])?void 0:i.children;if(l&&this.enableSessionStorage[e]){var s=[];for(let t=0;t<l.length;t+=2){let e={};var o=l[t];e="0"===o.style.flexGrow||"1"===o.style.flexGrow?Object.assign(Object.assign({},e),{flexGrow:o.style.flexGrow,flexBasis:o.style.flexBasis}):Object.assign(Object.assign({},e),{flexBasis:o.style.flexBasis,flexGrow:"-1"}),s.push(e)}return this.userSession.SetSession(s,"horizontal"===r?"horizontal":"vertical",t),!0}}else console.error("Wrapper not set. Call setWrapper before using saveSizesToLocalStorage.");return!1}static saveHorizontalSizesToLocalStorage(){this.saveSizesToLocalStorage("horizontal")}static saveVerticalSizesToLocalStorage(){this.saveSizesToLocalStorage("vertical")}}SplitUtils.TOP="top",SplitUtils.BOTTOM="bottom",SplitUtils.LEFT="left",SplitUtils.RIGHT="right",SplitUtils.HORIZONTAL="horizontal",SplitUtils.VERTICAL="vertical",SplitUtils.SECTION_CLASS_HIDE="a-split-hidden",SplitUtils.FIX_CLASS="a-split-pane-fix",SplitUtils.FIX_HELPER_CLASS="a-split-pane-helper-fix",SplitUtils.wrapper=null,SplitUtils.mode="horizontal",SplitUtils.modeWrapper={horizontal:null,vertical:null},SplitUtils.enableSessionStorage={horizontal:!1,vertical:!1},SplitUtils.cachedMappedSplitPanePosition={horizontal:null,vertical:null},SplitUtils.splitPaneInstance=null;export default SplitUtils;